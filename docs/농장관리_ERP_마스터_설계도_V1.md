# 🍓 농장관리 ERP 마스터 설계도 (FARM ERP BLUEPRINT) V1.0

> **기획자**: 사장님 (강찬구님)  
> **설계 보좌**: Antigravity AI  
> **최종 갱신**: 2026-02-21

이 문서는 단순한 소스코드 설명을 넘어, 사장님의 농장 경영 철학과 현장 노하우가 AI 기술과 결합된 **비즈니스 자산**입니다. 새로운 시스템을 구축하거나 확장할 때 이 설계도를 기반으로 삼으시면 됩니다.

---

## 🏛️ 시스템 아키텍처 개요 (Tech Stack)
*   **Frontend**: Next.js (React) - 모바일 퍼스트 반응형 UI
*   **Backend/DB**: Supabase (PostgreSQL) - 실시간 데이터 동기화
*   **Styling**: Tailwind CSS & Lucide Icons - 프리미엄 다크/화이트 모드 디자인
*   **Core Concepts**: RBAC(권한 분리), PDCA 방법론, 데이터 무결성 보장

---

## 🧩 핵심 모듈별 비즈니스 플로우

### 1. 마스터 계정 및 보안 체계 (Auth & RBAC)
*   **로직**: 사장님(Admin)은 하우스별 매출 및 전체 재무 지표에 접근. 직원은 출근부 및 수확 기록 관리.
*   **특징**: 소셜 로그인을 통한 간편 인증 및 농장별 독립된 데이터 공간(Multi-tenancy) 확보.

### 2. 지능형 인적 관리 및 근태 (HR & Attendance)
*   **플로우**: 외국인 노동자/일용직 등록 -> 달력 기반 출근 기록 -> 성질(일당/시급/고정급)에 따른 임금 자동 산출.
*   **핵심 노하우**: 
    *   당일 기록뿐만 아니라 **'과거 기록 소급 입력'** 기능 필수.
    *   지불 대기 중인 임금을 부채로 자동 인식하여 재무 모듈에 전달.

### 3. 생산 중심 영농일지 (Harvest & House Diary)
*   **플로우**: 12개 하우스 동별 수확량(kg/박스) 기록 -> 영농 특이사항(온도, 병해충 등) 기록.
*   **핵심 노하우**: 
    *   하우스별 수취가 분석을 통해 "어느 동이 가장 수익성이 높은가"를 시각화.
    *   기존 영농일지와 수확 기록을 통합하여 효율성 극대화.

### 4. 지능형 판매 및 출하 (Sales & Fulfillment) *[가장 고도화됨]*
*   **플로우**: B2B(농협/납품)와 B2C(개별 택배) 탭 분리 운영.
*   **핵심 노하우 (사장님표 정수)**:
    *   **주문자/수령인 엄격 분리**: 돈 내는 사람과 받는 사람을 DB에서 각각 관리 (1인 다수 배송 지원).
    *   **운영 편의 기능**: '주문자 고정(Lock)' 및 '주문자와 동일' 버튼으로 현장 입력 시간 80% 단축.
    *   **비용 자동화**: 박스 수량에 따른 배송비/자재비 자동 차감 및 순수익 시뮬레이션.
    *   **최근 배송지**: 고객별 최근 5건의 배송지를 지능적으로 노출하여 중복 입력 방지.

### 5. 통합 재무 및 정산 관리 (Finance & Settlement)
*   **플로우**: 전체 매출 - 인건비 - 부대 비용 = 실질 순이익 도출.
*   **핵심 노하우**: 
    *   미정산(B2B) 대금에 대한 시각적 경고(Amber 색상) 및 필터링 기능.
    *   현금 흐름(Cash Flow)의 실시간 가시성 확보.

---

## 🌍 범용 농장 ERP 확장 전략 (Generalization & Expansion)
사장님의 비전인 "딸기를 넘어선 통합 농장 관리"를 위해 기존 시스템을 파괴하지 않고 확장하는 핵심 전략입니다.

### 1. 하우스(동)의 자율 명칭제 (House Nicknaming)
*   **전략**: 기존 DB의 하우스 번호(1~12)는 유지하되, `alias(별명)` 필드를 추가합니다.
*   **결과**: "1동(딸기)", "2동(고구마)", "3동(감자)" 처럼 사장님이 동마다 작물을 자유롭게 지정하고 관리할 수 있습니다.

### 2. 단위(Unit) 추상화 및 자동화
*   **전략**: 수량(`quantity`) 필드 옆에 단위(`unit`) 필드를 추가합니다.
*   **결과**: '박스'뿐만 아니라 'kg', 'g', '송이' 등 작물에 맞는 단위를 선택할 수 있으며, 정확한 데이터 기반의 단가 계산(Unit Price)이 가능해집니다.

### 3. 로스 및 폐기 관리 (Loss/Discard Tracking)
*   **전략**: 수확 기록에 `discard_quantity(폐기량)` 필드를 추가합니다.
*   **결과**: 딸기처럼 보관이 어렵고 폐기율이 높은 작물도 "실제 수확량 대비 정품 판매율"을 정확히 분석하여 경영 효율을 높일 수 있습니다.

### 4. 작물별 카테고리(Category) 마스터 도입
*   **전략**: 별도의 작물 테이블을 두어 판매/수확 기록과 연관 지습니다.
*   **결과**: "올해 딸기 수익 vs 고구마 수익"을 한눈에 비교하는 통합 대시보드가 가능해집니다.

---

## 🚀 향후 재사용 및 확장 가이드
1.  **새 프로젝트 시작 시**: 이 설계도의 [범용 농장 확장 전략]을 먼저 선언하여 작물에 구애받지 않는 뼈대를 구축합니다.
2.  **데이터 무결성**: 위 확장안은 모두 **'필드 추가'** 방식이므로 기존 데이터가 삭제되거나 연계성이 깨지지 않는 안전한 방식입니다.
3.  **데이터 가치**: 쌓인 데이터는 나중에 '수확량 예측 AI'나 '적정 판매가 제안' 기능의 학습 데이터로 활용.

---

> [!IMPORTANT]
> 이 설계도는 개발자의 코드가 아니라, **사장님의 경영 노하우**가 담긴 문서입니다. 분실하지 않도록 이 위치에 영구 보존합니다.
